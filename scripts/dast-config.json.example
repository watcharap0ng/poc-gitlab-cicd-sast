{
  "description": "DAST Standalone Scanner Configuration",
  "version": "1.0.0",
  "created": "2025-01-01",
  "compatible_with": "poc-gitlab-cicd-sast v2.0+",

  "_comment": "This is a template configuration file for the DAST standalone scanner. Copy to 'dast-config.json' and customize for your environment.",

  "scan_configuration": {
    "_comment": "Core scanning parameters based on GitLab CI pipeline configuration",
    "scan_depth": 5,
    "threads": 5,
    "max_duration": 1800,
    "delay_ms": 0,
    "ajax_spider": true,
    "ajax_spider_max_duration": 1800,
    "browser_id": "chrome-headless",
    "spider_max_depth": 10,
    "spider_max_children": 100,
    "spider_accept_cookies": true,
    "spider_handle_parameters": true
  },

  "authentication": {
    "_comment": "Authentication configuration - set method and corresponding parameters",
    "method": "none",
    "username": "",
    "password": "",
    "token": "",
    "cookies": "",
    "auth_url": "",
    "login_field": "username",
    "password_field": "password",
    "verify_url": "",
    "logout_url": "",
    "_examples": {
      "form_authentication": {
        "method": "form",
        "username": "testuser",
        "password": "testpass",
        "auth_url": "https://example.com/login",
        "login_field": "username",
        "password_field": "password",
        "verify_url": "https://example.com/dashboard"
      },
      "token_authentication": {
        "method": "token",
        "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
        "verify_url": "https://api.example.com/health"
      },
      "cookie_authentication": {
        "method": "cookie",
        "cookies": "session=abc123; csrf=def456; auth=token789",
        "verify_url": "https://example.com/secure"
      }
    }
  },

  "exclusions": {
    "_comment": "URLs, parameters, and headers to exclude from scanning - based on existing pipeline exclusions",
    "exclude_urls": ".*\\.css$,.*\\.js$,.*\\.png$,.*\\.jpg$,.*\\.gif$,.*\\.svg$,.*logout.*,.*admin.*,.*settings.*,.*profile.*,.*account.*",
    "exclude_params": "session.*,csrf.*,auth.*,token.*,api_key.*,password.*,confirm.*",
    "exclude_headers": "X-Debug,X-Requested-With,X-Dev-Tools",
    "exclude_cookies": "session.*,csrf.*,auth.*,token.*",
    "exclude_status_codes": "404,500,502,503"
  },

  "zap_configuration": {
    "_comment": "OWASP ZAP specific configuration - aligned with existing CI/CD setup",
    "context_name": "dast-scan-context",
    "technology": "NodeJS,React,JavaScript,HTML5",
    "allowed_hosts": "",
    "authentication_strategy": "detect",
    "docker_image": "owasp/zap2docker-stable",
    "host": "localhost",
    "port": 8090,
    "api_key": "",
    "_technology_options": [
      "NodeJS", "React", "Angular", "Vue.js", "PHP", "Java",
      "Python", "Ruby", ".NET", "Docker", "Kubernetes",
      "HTML5", "JavaScript", "TypeScript", "REST", "GraphQL"
    ]
  },

  "defectdojo": {
    "_comment": "DefectDojo integration configuration - reuses existing upload script",
    "url": "",
    "token": "",
    "project_name": "",
    "engagement_name": "",
    "auto_create": true,
    "upload_findings": true,
    "product_type": 1,
    "test_type": 1,
    "environment": "Production",
    "_setup_notes": [
      "Set url to your DefectDojo instance (e.g., https://defectdojo.example.com)",
      "Generate an API token in DefectDojo under User Profile > API Keys",
      "Specify project_name or enable auto_create for new projects",
      "engagement_name will default to 'DAST Scan [timestamp]' if not specified"
    ]
  },

  "security_policy": {
    "_comment": "Security policy validation settings - matches existing pipeline rules",
    "fail_on_high_critical": true,
    "fail_on_medium": false,
    "max_high_vulnerabilities": 0,
    "max_medium_vulnerabilities": 10,
    "max_low_vulnerabilities": 50,
    "policy_rules": {
      "critical_threshold": 0,
      "high_threshold": 0,
      "medium_threshold": 10,
      "low_threshold": 50
    }
  },

  "output": {
    "_comment": "Output configuration and reporting options",
    "report_dir": "./dast-reports",
    "report_name": "dast-report",
    "generate_html": true,
    "generate_markdown": true,
    "generate_metrics": true,
    "verbose": true,
    "preserve_workspace": false,
    "report_formats": ["json", "html", "markdown"],
    "retention_days": 30
  },

  "environment": {
    "_comment": "Environment-specific settings and variables",
    "dast_work_dir": "",
    "zap_api_key": "",
    "fail_on_high_critical": "true",
    "fail_on_medium": "false",
    "slack_webhook_url": "",
    "slack_channel": "#security-alerts",
    "_environment_variables": [
      "DAST_CONFIG",
      "DAST_WORK_DIR",
      "DAST_REPORT_DIR",
      "ZAP_API_KEY",
      "ZAP_DOCKER_IMAGE",
      "FAIL_ON_HIGH_CRITICAL",
      "FAIL_ON_MEDIUM",
      "SLACK_WEBHOOK_URL",
      "SLACK_CHANNEL"
    ]
  },

  "ci_cd_integration": {
    "_comment": "CI/CD pipeline integration settings",
    "gitlab_ci": {
      "variables": [
        "ZAP_API_KEY",
        "DAST_USERNAME",
        "DAST_PASSWORD",
        "DAST_TOKEN",
        "ZAP_SCAN_DEPTH",
        "ZAP_THREADS",
        "ZAP_MAX_DURATION",
        "ZAP_EXCLUDE_URLS",
        "FAIL_ON_HIGH_CRITICAL",
        "FAIL_ON_MEDIUM"
      ],
      "artifacts": {
        "reports": {
          "paths": ["dast-reports/"],
          "expire_in": "1 week"
        }
      },
      "timeout": "30 minutes"
    },
    "github_actions": {
      "secrets": [
        "ZAP_API_KEY",
        "DAST_USERNAME",
        "DAST_PASSWORD",
        "DAST_TOKEN",
        "DEFECTDOJO_TOKEN",
        "DEFECTDOJO_URL"
      ],
      "outputs": [
        "dast-results",
        "security-policy-report",
        "defectdojo-engagement-id"
      ]
    }
  },

  "usage_examples": {
    "_comment": "Example usage commands for different scenarios",
    "basic_scan": "./dast-standalone.sh https://example.com",
    "authenticated_scan": "./dast-standalone.sh -a form -u admin -p password https://app.example.com",
    "advanced_scan": "./dast-standalone.sh -d 10 -T 8 --max-duration 3600 --defectdojo-url https://defectdojo.example.com --defectdojo-token YOUR_TOKEN https://api.example.com",
    "config_file_scan": "./dast-standalone.sh -c dast-config.json https://production.example.com",
    "create_config": "./dast-standalone.sh --create-config"
  }
}